---
header-includes: 
  - \usepackage{booktabs}
  - \AtBeginDocument{\let\maketitle\relax}
  - \usepackage[utf8]{inputenc}
  - \usepackage[english]{babel}
  - \usepackage{float}
output:
  pdf_document
fontsize: 12pt 
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo    = TRUE, 
  message = FALSE,
  digits  = 4
)
library(tidyverse)
library(shiny)

```

\newcommand{\iid}{\overset{\mathrm{i.i.d}}{\sim}}
\newcommand{\dados}{\ | \ }
\newcommand{\bbeta}{\boldsymbol\beta}
\newcommand{\R}{\mathbb{R}}
\newcommand{\props}{\ \propto \ }
\renewcommand{\labelitemi}{$\bullet$}
\newtheorem{proof}{Solución}

\begin{minipage}{2.5cm}
			\includegraphics[width=1.8cm]{logouccolor.jpg}
		\end{minipage}
\begin{minipage}{13cm}
	\begin{flushleft}
   		\raggedright{
   		  \noindent
   		 	 {\sc Pontificia Universidad Católica de Chile \\ 
   			     			Facultad de Matemáticas \\ 
   			     			Departamento de Estad\'istica \sc
   			     			}
    			    	}
			\end{flushleft}
		\end{minipage}

\begin{center} \quad \\[0.3cm]
  {\Large Actividad Práctica II} \\[0.3cm]
  Rubén Soza \\
  Computación Estadística con R \\[0.3cm]
  05 de Septiembre de 2019
\end{center}

## Instrucciones

Carge la base de datos `PlayStore.xlsx`, junto con `tidyverse` y las librerías necesarias para utilizar `Shiny`. Las soluciones del Problema 1 y 2 debe realizarlas en un `Rmarkdown`, mientras que para el problema 3 debe entregar un script de R que genere la aplicación Shiny deseada.

## Problema 1

- Utilizando la ayuda de `R`, estudie las funciones `as.numeric()` y `str_remove_all()`.
- Combine las dos funciones anteriores para transformar la columna `Descargas` en una variable numérica en R.
- Usted sabe que las `Ganancias` de una aplicación son calculadas como el número de descargas de dicha aplicación multiplicada por el precio de la misma. Seleccionando solo las variables que son de pago, calcule el promedio de `Ganancias` por `Categoría`.

- Reporte sus resultados en una tabla y en una oración reporte los valores mínimos y máximos obtenidos junto con sus respectivas aplicaciones.

```{r, echo = FALSE}
library(readxl)
PlayStore <- read_excel("G:/Mi unidad/Universidad/Cursos/Computación Estadística con R/Datasets/PlayStore.xlsx")
```

## Problema 2

- Genere un gráfico boxplot de la `Valoración` para cada `Categoría`. Agregue a su gráfico las siguientes líneas de código. Comente lo obtenido.

    ```{r, eval = FALSE}
# boxplot +
      coord_flip() +
      theme(legend.position = "none")
factor()
```

- Genere un gráfico de barras que ilustre la `Clasificación` de las aplicaciones. Considere en su solución el siguiente código y comente su utilidad.

```{r, eval = FALSE}
PlayStore %>% 
  mutate(Clasificación = factor(Clasificación, 
                                levels = c("Todo público", "Mayores de 10 años", 
                                           "Adolescentes", "Mayores de 17 años", 
                                           "Sólo adultos", "Sin clasificación")))
```

- Genere un indicador de 3 categorías sobre la variable `Comentarios`. Sobre cada indicador, realice un gráfico de dispersión de la `Valoración` vs `Tamaño` que además aporte información del precio de la aplicación.

## Problema 3

Genere una aplicación en `Shiny` que cumpla las siguientes características:

- Permita al usuario seleccionar una `Categoría`, con la cual se reportará una tabla de la base de datos filtrada y un gráfico de dispersión de `Descargas` vs `Precio` considerando solo los elementos de la categoría seleccionada.
- Permita al usuario modificar el color y tamaño de los puntos.
- Permita al usuario modificar el título del gráfico.

Para lo anterior, puede ser útil el siguiente código:
```{r, eval = FALSE}
library(plotly)
library(shiny)
ui <- fluidPage(
  sidebarLayout(
    selectInput(inputId = "categoría", label = "Seleccione la categoría", 
                values = c("ARTE Y DISEÑO", "BELLEZA", "CASA Y HOGAR",
                           "CLIMA", "COMIDA Y BEBIDA", "COMPRAS",
                           "COMUNICACIÓN", "DATOS", "DEPORTES",
                           "EDUCACIÓN", "ENTRETENIMIENTO", "ESTILO DE VIDA",
                           "EVENTOS", "FAMILIA", "FINANCIERAS",     
                           "FOTOGRAFÍA", "HERRAMIENTAS", "HISTORIETAS", 
                           "JUEGO", "LIBRERIAS", "LIBROS Y REFRERENCIAS",
                           "MAPAS Y NAVEGACIÓN", "MÉDICO", "NEGOCIO", 
                           "NOTICIAS", "PADRES", "PERSONALIZACIÓN",
                           "PRODUCTIVIDAD", "REPRODUCTORES DE VIDEO", "SALUD Y BELLEZA",
                           "SOCIAL", "VEHICULOS", "VIAJES", select = "DEPORTES")
    ),
    textInput("_ _ _"),
    sliderInput("_ _ _"),
    "_ _ _"Input(inputId = "color", label = "Color de Puntos", values = c("red","blue","green"), select = "red"),
    mainPanel(tableOutput("tabla"), plotOutput("dispersion"))
  )
)

server <- function(input,output){
  PlayStore %>% 
    filter( Categoría == input$categoría) -> PlayStore_filtrada
  output$"_ _ _" <- renderDataTable("_ _ _")
  g <- ggplot(data = PlayStore_filtrada) + "_ _ _"
  output$dispersión <- "_ _ _"(plotly(g))
}

runApp(ui,server)
```




